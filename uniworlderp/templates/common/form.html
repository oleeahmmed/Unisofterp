{% extends "base.html" %}
{% load static %}

{% block main_content %}
<div class="min-h-screen p-4">
    <div class="w-full">
        <!-- Card Container -->
        <div class="bg-[hsl(var(--card))] backdrop-filter backdrop-blur-lg rounded-lg shadow-xl overflow-hidden border border-[hsl(var(--border))]">
            <!-- Card Header -->
            <div class="bg-gradient-to-br from-[#0d834e] to-black text-white px-6 py-4">
                <h2 class="text-xl font-semibold text-white">{{ action }} {{ model_name }}</h2>
            </div>

            <!-- Card Content -->
            <div class="p-6 space-y-6 sm:space-y-4">
                <form method="post" enctype="multipart/form-data" class="space-y-6 sm:space-y-4">

                    {% csrf_token %}
                    {% include "message.html" %}

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {% for field in form %}
                        <div class="form-field">
                            {% if field.field.widget.input_type == "select" %}
                                <select name="{{ field.name }}" 
                                        id="{{ field.id_for_label }}" 
                                        class="form-input bg-[hsl(var(--input))] text-[hsl(var(--foreground))] border-[hsl(var(--border))]"
                                        {% if field.field.required %}required{% endif %}>
                                    {% for choice in field.field.choices %}
                                        <option value="{{ choice.0 }}" {% if field.value|stringformat:"s" == choice.0|stringformat:"s" %}selected{% endif %}>
                                            {{ choice.1 }}
                                        </option>
                                    {% endfor %}
                                </select>
                            {% elif field.field.widget.input_type == "textarea" %}
                                <textarea name="{{ field.name }}" 
                                          id="{{ field.id_for_label }}" 
                                          class="form-input bg-[hsl(var(--input))] text-[hsl(var(--foreground))] border-[hsl(var(--border))]"
                                          placeholder=" "
                                          {% if field.field.required %}required{% endif %}>{{ field.value|default:'' }}</textarea>
                            {% elif field.field.widget.input_type == "date" %}
                                <input type="date" 
                                       name="{{ field.name }}" 
                                       id="{{ field.id_for_label }}" 
                                       class="form-input bg-[hsl(var(--input))] text-[hsl(var(--foreground))] border-[hsl(var(--border))]"
                                       value="{% if field.value %}{{ field.value|date:'Y-m-d' }}{% elif field.field.initial %}{{ field.field.initial|date:'Y-m-d' }}{% endif %}"
                                       {% if field.field.required %}required{% endif %}>
                            {% else %}
                                <input type="{{ field.field.widget.input_type }}" 
                                       name="{{ field.name }}" 
                                       id="{{ field.id_for_label }}" 
                                       class="form-input bg-[hsl(var(--input))] text-[hsl(var(--foreground))] border-[hsl(var(--border))]"
                                       placeholder=" "
                                       value="{{ field.value|default:'' }}"
                                       {% if field.field.required %}required{% endif %}>
                            {% endif %}
                            <label for="{{ field.id_for_label }}" class="form-label bg-[hsl(var(--card))] text-[hsl(var(--muted-foreground))]">
                                {{ field.label }}{% if field.field.required %}<span class="text-[hsl(var(--destructive))]">*</span>{% endif %}
                            </label>
                            {% if field.errors %}
                            <div class="error-message text-[hsl(var(--destructive))]">
                                {% for error in field.errors %}
                                <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>

                    <div class="flex justify-end space-x-3 flex-wrap gap-2">
                        {% if can_add %}
                        <button type="submit" class="group relative px-6 py-3 text-white font-semibold text-sm uppercase tracking-wider overflow-hidden rounded-md shadow-lg bg-gradient-to-br from-[#0d834e] to-black hover:from-[#0a6b3f] hover:to-[#333333] transition-all duration-300 ease-out hover:shadow-xl">
                            <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-20 transition-opacity duration-300 ease-out"></span>
                            <span class="relative flex items-center">
                                <svg class="w-5 h-5 mr-2 transform group-hover:rotate-12 transition-transform duration-300 ease-out" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                <span class="transform group-hover:translate-x-1 transition-transform duration-300 ease-out">Save {{ model_name }}</span>
                            </span>
                        </button>
                        {% elif can_edit %}
                        <button type="submit" class="group relative px-6 py-3 text-white font-semibold text-sm uppercase tracking-wider overflow-hidden rounded-md shadow-lg bg-gradient-to-br from-[#0d834e] to-black hover:from-[#0a6b3f] hover:to-[#333333] transition-all duration-300 ease-out hover:shadow-xl">
                            <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-20 transition-opacity duration-300 ease-out"></span>
                            <span class="relative flex items-center">
                                <svg class="w-5 h-5 mr-2 transform group-hover:rotate-12 transition-transform duration-300 ease-out" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                                <span class="transform group-hover:translate-x-1 transition-transform duration-300 ease-out">Edit {{ model_name }}</span>
                            </span>
                        </button>
                        {% elif can_view %}
                        <a href="{% url list_url %}" class="group relative px-6 py-3 text-white font-semibold text-sm uppercase tracking-wider overflow-hidden rounded-md shadow-lg bg-gradient-to-br from-[#0d834e] to-black hover:from-[#0a6b3f] hover:to-[#333333] transition-all duration-300 ease-out hover:shadow-xl">
                            <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-20 transition-opacity duration-300 ease-out"></span>
                            <span class="relative flex items-center">
                                <svg class="w-5 h-5 mr-2 transform group-hover:-translate-x-1 transition-transform duration-300 ease-out" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                                </svg>
                                <span class="transform group-hover:translate-x-1 transition-transform duration-300 ease-out">Back to List</span>
                            </span>
                        </a>
                        {% elif can_add %}
                        <a href="{% url add_url %}" class="group relative px-6 py-3 text-white font-semibold text-sm uppercase tracking-wider overflow-hidden rounded-md shadow-lg bg-gradient-to-br from-[#0d834e] to-black hover:from-[#0a6b3f] hover:to-[#333333] transition-all duration-300 ease-out hover:shadow-xl">
                            <span class="absolute inset-0 bg-white opacity-0 group-hover:opacity-20 transition-opacity duration-300 ease-out"></span>
                            <span class="relative flex items-center">
                                <svg class="w-5 h-5 mr-2 transform group-hover:-translate-x-1 transition-transform duration-300 ease-out" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v14m7-7H5"></path>
                                </svg>
                                <span class="transform group-hover:translate-x-1 transition-transform duration-300 ease-out">Add {{ model_name }}</span>
                            </span>
                        </a>
                        {% endif %}
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function refreshPage() {
        location.reload();
    }
</script>
{% endblock %}